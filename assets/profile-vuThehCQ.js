import"./modulepreload-polyfill-B5Qt9EMX.js";import{b as g,a as d}from"./firebase-BrtCog--.js";const f="https://binarybandits-profileapi.onrender.com",l=`
            <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="40" cy="40" r="40" fill="#E0E0E0"/>
                <circle cx="40" cy="32" r="16" fill="#BDBDBD"/>
                <ellipse cx="40" cy="60" rx="22" ry="12" fill="#BDBDBD"/>
            </svg>
        `,i={NO_USER_ID:"Error: No userId provided in the URL.",PROFILE_FETCH_FAILED:"Unable to load profile. Please try again later.",NO_PROFILE_FOUND:"No profile found for this user.",AUTH_REQUIRED:"Authentication required. Redirecting to login...",NETWORK_ERROR:"Network error. Please check your connection and try again."};function c(t){try{return new URLSearchParams(window.location.search).get(t)}catch(e){return console.error("Error parsing query parameters:",e),null}}function u(t){if(!t)return"";const e=document.createElement("div");return e.textContent=t,e.innerHTML}function m(t){return!Array.isArray(t)||t.length===0?'<div class="hobby-item"><span class="hobby-text">No hobbies listed</span></div>':t.filter(e=>e&&typeof e=="string").map(e=>`
                    <div class="hobby-item">
                        <span class="hobby-text">${u(e)}</span>
                    </div>
                `).join("")}function a(t,e=".main-container"){const r=document.querySelector(e);r&&(r.innerHTML=`
                    <div class="error-message">
                        <strong>Error:</strong> ${u(t)}
                    </div>
                `)}function E(){const t=document.querySelector(".profile-pic");t&&(t.innerHTML=l,t.style.pointerEvents="none",t.style.cursor="default")}function h(){const t=document.querySelector(".start-chat-btn");if(t){const e=c("userId");t.addEventListener("click",r=>{r.preventDefault(),e?window.location.href=`chats.html?targetUser=${encodeURIComponent(e)}`:window.location.href="chats.html"})}}function p(t){const e={username:document.getElementById("username"),userDescription:document.getElementById("userDescription"),ageDetail:document.getElementById("ageDetail"),genderDetail:document.getElementById("genderDetail"),regionDetail:document.getElementById("regionDetail"),languagesDetail:document.getElementById("languagesDetail"),hobbiesList:document.getElementById("hobbiesList"),profilePic:document.getElementById("profilePic")},r=Object.entries(e).filter(([o,n])=>!n).map(([o,n])=>o);if(r.length>0&&console.warn("Missing DOM elements:",r),e.username&&(e.username.textContent=t.username||"Unknown User"),e.userDescription&&(e.userDescription.textContent=t.bio||"No bio provided."),e.ageDetail&&(e.ageDetail.textContent=`Age: ${t.ageRange||"Not specified"}`),e.genderDetail&&(e.genderDetail.textContent=`Gender: ${t.gender||"Not specified"}`),e.regionDetail&&(e.regionDetail.textContent=`Region: ${t.region||"Not specified"}`),e.languagesDetail){const o=Array.isArray(t.languages)?t.languages.filter(n=>n).join(", "):t.languages||"Not specified";e.languagesDetail.textContent=`Languages: ${o}`}e.hobbiesList&&(e.hobbiesList.innerHTML=m(t.hobbies)),e.profilePic&&(e.profilePic.innerHTML=l)}async function y(t,e){const r=new AbortController,o=setTimeout(()=>r.abort(),1e4);try{const n=await fetch(`${f}/${encodeURIComponent(t)}`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},signal:r.signal});if(clearTimeout(o),n.status===404)throw new Error(i.NO_PROFILE_FOUND);if(n.status===401||n.status===403)throw new Error(i.AUTH_REQUIRED);if(!n.ok)throw new Error(`HTTP ${n.status}: ${i.PROFILE_FETCH_FAILED}`);const s=await n.json();if(!s||typeof s!="object")throw new Error(i.NO_PROFILE_FOUND);return s}catch(n){throw clearTimeout(o),n.name==="AbortError"?new Error("Request timeout. Please try again."):n instanceof TypeError&&n.message.includes("fetch")?new Error(i.NETWORK_ERROR):n}}async function D(){const t=c("userId");if(!t){a(i.NO_USER_ID);return}g(d,async e=>{if(!e){console.log("No authenticated user, redirecting to login"),setTimeout(()=>{window.location.href="login.html"},100);return}try{const r=await e.getIdToken();console.log("Fetching profile for userId:",t);const o=await y(t,r);console.log("Profile data loaded:",o),p(o)}catch(r){console.error("Error loading profile:",r),a(r.message||i.PROFILE_FETCH_FAILED,".profile-card")}},e=>{console.error("Auth state change error:",e),a("Authentication error. Please try logging in again.")})}document.addEventListener("DOMContentLoaded",()=>{E(),h(),D()});
